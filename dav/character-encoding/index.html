<!DOCTYPE html>
<head lang="en">

    
  
            <title>Character Encoding - sabre/dav</title>
    
    <meta charset="utf-8">

    <link rel="alternate" type="application/atom+xml" href="https://sabre.io/atom.xml" title="sabre.io blog">
    <link rel="icon" href="https://sabre.io/favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,700,300,400" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link rel="stylesheet" type="text/css" href="https://sabre.io/css/sabre.css">
    
</head>
<body >
    <header class="pagehead">

    <div class="pagehead-inner">
        <a class="logo" href="https://sabre.io/">
                            <img src="https://sabre.io/img/logo.png" alt="sabre/sabre/dav">
                sabre<span>/dav</span>
                    </a>

        <nav class="nav nav--page">
            <ul>
                <li class="size-auto"></li>
                <li><a href="https://sabre.io/dav">Docs</a></li>
                <li><a href="https://sabre.io/blog">Blog</a></li>
                <li><a href="https://sabre.io/support">Support</a></li>
                <li class="size-auto text--right"><a href="https://github.com/sabre-io"><i class="fa fa-github"></i></a></li>
                <!-- <li><a href="https://sabre.io/atom.xml"><i class="fa fa-rss"></i></a> <a href="https://twitter.com/sabredav"><i class="fa fa-twitter"></i></a></li> -->
            </ul>
        </nav>

    </div>

</header>

            <input class="hamburger-input" type="checkbox" id="nav-check" name="nav-check">
        <label class="hamburger-label" for="nav-check"><i class="fa fa-bars"></i></label>
    
        <main  class="incl-sidebar">
                    <aside class="sidebar">
    <nav class="nav nav--sidebar">
        <ul class="list list--nav">
            <li><a href="https://sabre.io/dav">sabre/dav</a>
                                <ul>
                    <li><a href="https://sabre.io/dav/install">Installation</a></li>
                    <li><a href="https://sabre.io/dav/upgrading">Upgrading</a></li>
                    <li><a href="https://sabre.io/dav/gettingstarted">Getting Started</a></li>
                    <li><a href="https://sabre.io/dav/extending-sabredav">Extending sabre/dav</a></li>
                    <li>Troubleshooting
                        <ul>
                            <li><a href="https://sabre.io/dav/faq">FAQ</a></li>
                            <li><a href="https://sabre.io/dav/clients">Clients</a></li>
                            <li><a href="https://sabre.io/dav/webservers">Webservers</a></li>
                        </ul>
                    </li>
                    <li>CalDAV
                        <ul>
                            <li><a href="https://sabre.io/dav/caldav">Getting started</a></li>
                            <li><a href="https://sabre.io/dav/building-a-caldav-client">Building a CalDAV client</a></li>
                            <li><a href="https://sabre.io/dav/caldav-carddav-integration-guide">Integration guide</a></li>
                            <li><a href="https://sabre.io/dav/caldav-proxy">Delegation</a></li>
                            <li><a href="https://sabre.io/dav/caldav-sharing">Calendar sharing</a></li>
                            <li><a href="https://sabre.io/dav/ics-export-plugin">iCalendar export</a></li>
                            <li><a href="https://sabre.io/dav/scheduling">Scheduling</a></li>
                            <li><a href="https://sabre.io/dav/service-discovery">Service Discovery</a></li>
                        </ul>
                    </li>
                    <li>CardDAV
                        <ul>
                            <li><a href="https://sabre.io/dav/carddav/">Getting started</a></li>
                            <li><a href="https://sabre.io/dav/building-a-carddav-client/">Building a CardDAV client</a></li>
                            <li><a href="https://sabre.io/dav/caldav-carddav-integration-guide/">Integration guide</a></li>
                            <li><a href="https://sabre.io/dav/carddav-directory/">CardDAV Directory</a></li>
                            <li><a href="https://sabre.io/dav/vcf-export-plugin/">vCard export</a></li>
                            <li><a href="https://sabre.io/dav/carddav-me-card/">Me-card</a></li>
                            <li><a href="https://sabre.io/dav/service-discovery/">Service Discovery</a></li>
                        </ul>
                    </li>
                    <li>Other topics
                        <ul>
                            <li><a href="https://sabre.io/dav/acl">Acl</a></li>
                            <li><a href="https://sabre.io/dav/authentication">Authentication</a></li>
                            <li><a href="https://sabre.io/dav/character-encoding">Character encoding</a></li>
                            <li><a href="https://sabre.io/dav/browser-plugin">Directory indexes</a></li>
                            <li><a href="https://sabre.io/dav/davmount">DavMount</a></li>
                            <li><a href="https://sabre.io/dav/guesscontenttype">Content Types</a></li>
                            <li><a href="https://sabre.io/dav/http-patch">PATCH support</a></li>
                            <li><a href="https://sabre.io/dav/large-files">Large files</a></li>
                            <li><a href="https://sabre.io/dav/litmus">Litmus</a></li>
                            <li><a href="https://sabre.io/dav/locks">Locks</a></li>
                            <li><a href="https://sabre.io/dav/plugins">Plugins</a></li>
                            <li><a href="https://sabre.io/dav/per-user-directories/">Per-user directories</a></li>
                            <li><a href="https://sabre.io/dav/properties">Properties</a></li>
                            <li><a href="https://sabre.io/dav/property-storage">Property storage</a></li>
                            <li><a href="https://sabre.io/dav/scalability">Scalability</a></li>
                            <li><a href="https://sabre.io/dav/simplecollection">SimpleCollection</a></li>
                            <li><a href="https://sabre.io/dav/standards-support">Standards Support</a></li>
                            <li><a href="https://sabre.io/dav/temporary-files">Temporary Files</a></li>
                            <li><a href="https://sabre.io/dav/versioning">Versioning</a></li>
                            <li><a href="https://sabre.io/dav/virtual-filesystems">Virtual filesystems</a></li>
                            <li><a href="https://sabre.io/dav/davclient">WebDAV client</a></li>
                            <li><a href="https://sabre.io/dav/sync">WebDAV sync</a></li>
                            <li><a href="https://sabre.io/dav/writing-plugins">Writing Plugins</a></li>
                            <li><a href="https://sabre.io/dav/xmlelements">XML Elements</a></li>
                            <li><a href="https://sabre.io/dav/0bytes">Zero byte files</a></li>
                        </ul>
                    </li>
                </ul>
                            </li>
            <li><a href="https://sabre.io/event">sabre/event</a>
                            </li>
            <li><a href="https://sabre.io/http">sabre/http</a>
                            </li>
            <li><a href="https://sabre.io/katana">sabre/katana</a>
                            </li>
            <li><a href="https://sabre.io/vobject">sabre/vobject</a>
                            </li>
            <li><a href="https://sabre.io/xml">sabre/xml</a>
                            </li>
            <li><a href="https://sabre.io/uri">sabre/uri</a>
                            </li>
            <li><a href="https://sabre.io/baikal/">Baïkal</a>
                            </li>
            <li><a href="https://sabre.io/license">License</a></li>
        </ul>
    </nav>
</aside>
                <article>
                            <h1>Character Encoding</h1>
                <h2 id="main-recommendation">Main recommendation</h2>

<p>If you are either a client or a server developer, and you have to create
paths for things I would highly recommend using characters from this list.</p>

<p>This includes:</p>

<pre><code>A-Z // uppercase
a-z // lowerchase
0-9 // numbers
- // dash
_ // underscore
. // full stop
</code></pre>

<p>This is the list of unreserved characters, with one exception: it doesn't
include the tilde (<code>~</code>).</p>

<p>These characters are pretty much guaranteed to work correctly across the
board. Everything else may be <a href="https://en.wikipedia.org/wiki/Percent-encoding">percent encoded</a>, depending on the client.</p>

<h2 id="problems-with-percent-encoding">Problems with percent encoding</h2>

<p>The following three urls are technically equivalent:</p>

<pre><code>http://example.org/~evert
http://example.org/%7eevert
http://example.org/%7Eevert
</code></pre>

<p>Bad clients may just look at those urls and consider them all as different
urls. This causes really weird bugs.</p>

<p>A second problem is characters that are not part of ascii, such as ü.</p>

<p>The ü (u-umlaut) may be encoded in different ways, usually either UTF-8 or
ISO-8859-1 (or CP-1252 or latin1, etc).</p>

<p>HTTP urls don't specify any encodings, they are just lists of bytes. As a
result a client may encode the url <code>http://example.org/üvert</code> as one of
the following:</p>

<pre><code>http://example.org/%FCvrt // latin-1
http://example.org/%C3%BCvrt // utf-8 normalization form C
http://example.org/u%CC%88vrt // utf-8 normalization form D
</code></pre>

<p>The last three urls are 'identical' for a user, but from a HTTP perspective
they are all distinct urls.</p>

<p>SabreDAV will accept either form and internally encode everything to UTF-8,
but we cannot fix bad-behaving clients.</p>

<h2 id="clients">Clients</h2>

<p>An incomplete list of clients that have issues with this:</p>

<h3 id="windows">Windows</h3>

<p>Windows encodes files as ISO-8859-1 in request-urls. Starting SabreDAV
1.2.0alpha1 these will be automatically converted to their UTF-8 equivalents.</p>

<p>This only covers request-url's though, urls returned in PROPFIND bodies will
still be UTF-8. Some of these are reported to work, while others are not.</p>

<p>Read more on the <a href="/dav/clients/windows">Windows</a> documentation page.</p>

<h3 id="os%2Fx-finder">OS/X Finder</h3>

<p>OS/X finder uses UTF-8. In most cases this works without any issues. More
information can be found on the <a href="/dav/clients/finder">Finder</a> page.</p>

<h3 id="other-clients">Other clients</h3>

<ul>
<li><a href="/dav/clients/bitkinex">BitKinex</a> is a known offender.</li>
</ul>

<h2 id="internally">Internally</h2>

<p>All urls passed within SabreDAV are UTF-8 characters. Before 1.2.0alpha1
character sets were completely ignored, but now attempts are made to convert
to UTF-8 where possible.</p>

<p>In general this is only done to urls, specifically when urls are converted to
local paths and the reverse. This is all handled in <code>Sabre\DAV\URLUtil</code>.</p>

<h2 id="storage">Storage</h2>

<p>If you are using a database or other datastore to store your data (and url's),
you likely don't have to worry about this. Just make sure everything is UTF-8.</p>

<p>If you are using the filesystem to store files, this could be a little bit
problematic. Linux and OS/X treat file names as binary strings. When displayed
in an application, the character encoding that will be used is based on the
current locale. This is actually great, because there's no need to worry about
these.</p>

<p>Windows is different though. NTFS uses UTF-16 internally to store filenames,
but PHP's filesystem wrappers appear to use ISO-8859-1. This is problematic,
because there's no clean mapping possible in many cases.</p>

<p>It might be useful in those cases to simply urlencode every filename before
storing. This will give a cross-platform consistent result and the file names will
remain legible while checking it out with the console, etc.</p>

<p><a href="http://evertpot.com/filesystem-encoding-and-php/">More information on this topic</a></p>
            
            
                    </article>
    </main>
    
    <!-- this is where the ugly bit starts. Stupid javascript :( -->

    <script src="https://sabre.io/components/highlightjs/highlight.pack.js"></script>
    <script>
        hljs.configure({languages: ['php']});
        hljs.initHighlightingOnLoad();
    </script>

    
    <footer>

    <nav>
        <ul>
            <li>© 2024 <a href="https://fruux.com">fruux GmbH</a> · </li>
            <li><a href="https://sabre.io/support">Contact</a> · </li>
            <li><a href="https://sabre.io/legal">Legal Info</a></li>
        </ul>
        <ul>
            <li><i class="fa fa-twitter"></i> <a href="https://twitter.com/sabredav">@sabredav</a> · </li>
            <li><a href="https://twitter.com/fruux">@fruux</a></li>
                    </ul>
    </nav>

</footer>

</body>
