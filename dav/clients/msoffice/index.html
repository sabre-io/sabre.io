<!DOCTYPE html>
<head lang="en">

    
  
            <title>Microsoft Office - sabre/dav</title>
    
    <meta charset="utf-8">

    <link rel="alternate" type="application/atom+xml" href="https://sabre.io/atom.xml" title="sabre.io blog">
    <link rel="icon" href="https://sabre.io/favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,700,300,400" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link rel="stylesheet" type="text/css" href="https://sabre.io/css/sabre.css">
    
</head>
<body >
    <header class="pagehead">

    <div class="pagehead-inner">
        <a class="logo" href="https://sabre.io/">
                            <img src="https://sabre.io/img/logo.png" alt="sabre/sabre/dav">
                sabre<span>/dav</span>
                    </a>

        <nav class="nav nav--page">
            <ul>
                <li class="size-auto"></li>
                <li><a href="https://sabre.io/dav">Docs</a></li>
                <li><a href="https://sabre.io/blog">Blog</a></li>
                <li><a href="https://sabre.io/support">Support</a></li>
                <li class="size-auto text--right"><a href="https://github.com/sabre-io"><i class="fa fa-github"></i></a></li>
                <!-- <li><a href="https://sabre.io/atom.xml"><i class="fa fa-rss"></i></a> <a href="https://twitter.com/sabredav"><i class="fa fa-twitter"></i></a></li> -->
            </ul>
        </nav>

    </div>

</header>

            <input class="hamburger-input" type="checkbox" id="nav-check" name="nav-check">
        <label class="hamburger-label" for="nav-check"><i class="fa fa-bars"></i></label>
    
        <main  class="incl-sidebar">
                    <aside class="sidebar">
    <nav class="nav nav--sidebar">
        <ul class="list list--nav">
            <li><a href="https://sabre.io/dav">sabre/dav</a>
                                <ul>
                    <li><a href="https://sabre.io/dav/install">Installation</a></li>
                    <li><a href="https://sabre.io/dav/upgrading">Upgrading</a></li>
                    <li><a href="https://sabre.io/dav/gettingstarted">Getting Started</a></li>
                    <li><a href="https://sabre.io/dav/extending-sabredav">Extending sabre/dav</a></li>
                    <li>Troubleshooting
                        <ul>
                            <li><a href="https://sabre.io/dav/faq">FAQ</a></li>
                            <li><a href="https://sabre.io/dav/clients">Clients</a></li>
                            <li><a href="https://sabre.io/dav/webservers">Webservers</a></li>
                        </ul>
                    </li>
                    <li>CalDAV
                        <ul>
                            <li><a href="https://sabre.io/dav/caldav">Getting started</a></li>
                            <li><a href="https://sabre.io/dav/building-a-caldav-client">Building a CalDAV client</a></li>
                            <li><a href="https://sabre.io/dav/caldav-carddav-integration-guide">Integration guide</a></li>
                            <li><a href="https://sabre.io/dav/caldav-proxy">Delegation</a></li>
                            <li><a href="https://sabre.io/dav/caldav-sharing">Calendar sharing</a></li>
                            <li><a href="https://sabre.io/dav/ics-export-plugin">iCalendar export</a></li>
                            <li><a href="https://sabre.io/dav/scheduling">Scheduling</a></li>
                            <li><a href="https://sabre.io/dav/service-discovery">Service Discovery</a></li>
                        </ul>
                    </li>
                    <li>CardDAV
                        <ul>
                            <li><a href="https://sabre.io/dav/carddav/">Getting started</a></li>
                            <li><a href="https://sabre.io/dav/building-a-carddav-client/">Building a CardDAV client</a></li>
                            <li><a href="https://sabre.io/dav/caldav-carddav-integration-guide/">Integration guide</a></li>
                            <li><a href="https://sabre.io/dav/carddav-directory/">CardDAV Directory</a></li>
                            <li><a href="https://sabre.io/dav/vcf-export-plugin/">vCard export</a></li>
                            <li><a href="https://sabre.io/dav/carddav-me-card/">Me-card</a></li>
                            <li><a href="https://sabre.io/dav/service-discovery/">Service Discovery</a></li>
                        </ul>
                    </li>
                    <li>Other topics
                        <ul>
                            <li><a href="https://sabre.io/dav/acl">Acl</a></li>
                            <li><a href="https://sabre.io/dav/authentication">Authentication</a></li>
                            <li><a href="https://sabre.io/dav/character-encoding">Character encoding</a></li>
                            <li><a href="https://sabre.io/dav/browser-plugin">Directory indexes</a></li>
                            <li><a href="https://sabre.io/dav/davmount">DavMount</a></li>
                            <li><a href="https://sabre.io/dav/guesscontenttype">Content Types</a></li>
                            <li><a href="https://sabre.io/dav/http-patch">PATCH support</a></li>
                            <li><a href="https://sabre.io/dav/large-files">Large files</a></li>
                            <li><a href="https://sabre.io/dav/litmus">Litmus</a></li>
                            <li><a href="https://sabre.io/dav/locks">Locks</a></li>
                            <li><a href="https://sabre.io/dav/plugins">Plugins</a></li>
                            <li><a href="https://sabre.io/dav/per-user-directories/">Per-user directories</a></li>
                            <li><a href="https://sabre.io/dav/properties">Properties</a></li>
                            <li><a href="https://sabre.io/dav/property-storage">Property storage</a></li>
                            <li><a href="https://sabre.io/dav/scalability">Scalability</a></li>
                            <li><a href="https://sabre.io/dav/simplecollection">SimpleCollection</a></li>
                            <li><a href="https://sabre.io/dav/standards-support">Standards Support</a></li>
                            <li><a href="https://sabre.io/dav/temporary-files">Temporary Files</a></li>
                            <li><a href="https://sabre.io/dav/versioning">Versioning</a></li>
                            <li><a href="https://sabre.io/dav/virtual-filesystems">Virtual filesystems</a></li>
                            <li><a href="https://sabre.io/dav/davclient">WebDAV client</a></li>
                            <li><a href="https://sabre.io/dav/sync">WebDAV sync</a></li>
                            <li><a href="https://sabre.io/dav/writing-plugins">Writing Plugins</a></li>
                            <li><a href="https://sabre.io/dav/xmlelements">XML Elements</a></li>
                        </ul>
                    </li>
                </ul>
                            </li>
            <li><a href="https://sabre.io/event">sabre/event</a>
                            </li>
            <li><a href="https://sabre.io/http">sabre/http</a>
                            </li>
            <li><a href="https://sabre.io/katana">sabre/katana</a>
                            </li>
            <li><a href="https://sabre.io/vobject">sabre/vobject</a>
                            </li>
            <li><a href="https://sabre.io/xml">sabre/xml</a>
                            </li>
            <li><a href="https://sabre.io/uri">sabre/uri</a>
                            </li>
            <li><a href="https://sabre.io/baikal/">Baïkal</a>
                            </li>
            <li><a href="https://sabre.io/license">License</a></li>
        </ul>
    </nav>
</aside>
                <article>
                            <h1>Microsoft Office</h1>
                <p>Before MS Office 2000 there was no WebDAV support in the Office suite, but it
wasn't until Office 2003 when the company integrated a better client. For
information about how to work with WebDAV on versions prior to Office 2003,
you may find useful this page:</p>

<p><a href="http://www.atarex.com/services/support/webdav-msft.shtml">http://www.atarex.com/services/support/webdav-msft.shtml</a></p>

<p>The following observations of the Microsoft WebDAV client in Office was taken
using Word. Other applications of the suite may behave the same way.</p>

<h2 id="technical-details">Technical details</h2>

<p>Microsoft Office (at least Office 2k) uses the user agent:</p>

<pre><code>Microsoft Data Access Internet Publishing Provider DAV
</code></pre>

<h3 id="head-on-collections">HEAD on collections</h3>

<p>MS Office uses HEAD to find out if collections exist if it wants to create a
new collection. Before SabreDAV 1.1.0 alpha, we returned
<code>501 Not Implemented</code>, but this has since then been fixed. See <a href="https://github.com/sabre-io/dav/issues/100">Issue 100</a>
for details.</p>

<h3 id="authentication">Authentication</h3>

<p>Office understands both HTTP Basic and Digest authentication.</p>

<h3 id="reading-files">Reading files</h3>

<p>No problems found downloading and showing a document. Office will always
attempt to lock a file when opening, using <code>LOCK</code>.</p>

<h3 id="writing-files">Writing files</h3>

<p>Locks are required for saving, otherwise MS Word will open the file as read
only.</p>

<p>If a file is locked, Office 2007 and 2010 will ask you if you want to open the
file as read only, download and modify it only in your computer or allow
editing while in background the lock is checked at an interval (usually less
than 20 seconds) until the file is released.</p>

<p>Once Office 2003 and 2007 gets the lock, it is updated at the "x" minutes
interval you specify in your SabreDav locks plugin (30 minutes by default),
but this time cannot be less than 180 seconds.</p>

<p>Office 2010 (Beta) has some kind of bug which makes the program don't update
the lock anymore, so if another client checks the lock after the timeout, the
lock will be released. This behaviour was observed in the Beta, so it may be
corrected by the final product version.</p>

<h3 id="lockroot">Lockroot</h3>

<p>It was discovered that certain versions of Office break if the
<code>{DAV:}lockdiscovery</code> property contains a <code>{DAV:}lockroot</code> element.</p>

<p>To fix this, you can hide this element using the following code snippet:</p>

<pre><code>\Sabre\DAV\Xml\Property\LockDiscovery::$hideLockRoot = true;
</code></pre>

<p>Hiding it hasn't caused any issues for other clients, so it should be safe to call this.
This issue has so far been reported for both Office 2000, and office 2003 clients.</p>

<h3 id="properties">Properties</h3>

<p>Microsoft office may perform the following request to update a file's properties:</p>

<pre><code>&lt;D:propertyupdate xmlns:D="DAV:" xmlns:Z="urn:schemas-microsoft-com:"&gt;
    &lt;D:set&gt;
        &lt;D:prop&gt;
            &lt;Z:Win32CreationTime&gt;Mon, 12 Dec 2011 17:37:08 GMT&lt;/Z:Win32CreationTime&gt;
            &lt;Z:Win32LastAccessTime&gt;Mon, 12 Dec 2011 17:37:08 GMT&lt;/Z:Win32LastAccessTime&gt;
            &lt;Z:Win32LastModifiedTime&gt;Mon, 12 Dec 2011 17:37:08 GMT&lt;/Z:Win32LastModifiedTime&gt;
            &lt;Z:Win32FileAttributes&gt;00002002&lt;/Z:Win32FileAttributes&gt;
        &lt;/D:prop&gt;
    &lt;/D:set&gt;
&lt;/D:propertyupdate&gt;
</code></pre>

<p>However, it appears to disregard any existing locks on the resource, and
attempt to perform this request without any supplied lock tokens.</p>

<h3 id="office-2011-for-mac-notes">Office 2011 for mac notes</h3>

<p>When using the "Open URL" feature from Office 2011, it makes the following PROPFIND request:</p>

<pre><code>PROPFIND /filename.docx HTTP/1.1
From: 127.0.0.1
User-Agent: Microsoft Office
Accept: */*
Accept-Language: en
Translate: f
Brief: t
Depth: 0
Content-Type: text/xml; charset=utf-8
Content-Length: 236
Connection: Keep-Alive
Host: localhost:80

&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;D:propfind xmlns:D="DAV:"&gt;&lt;D:prop&gt;&lt;D:resourcetype/&gt;&lt;D:getetag/&gt;&lt;D:getcontentlength/&gt;&lt;D:getmodifiedby/&gt;&lt;D:creationdate/&gt;&lt;D:getlastmodified/&gt;&lt;D:lockdiscovery/&gt;&lt;D:supportedlock/&gt;&lt;/D:prop&gt;&lt;/D:propfind&gt;
</code></pre>

<h4 id="%7Bdav%3A%7Dsupportedlock">{DAV:}supportedlock</h4>

<p>This client had issues with how we encoded the <code>{DAV:}supportedlock</code>
property. This was fixed in SabreDAV version 1.7.4 and 1.8.2.</p>

<h4 id="%7Bdav%3A%7Dgetlastmodified">{DAV:}getlastmodified</h4>

<p>This client also has issues with our encoding for 'getlastmodified', which
used to look something like this:</p>

<pre><code>&lt;d:getlastmodified xmlns:b="urn:uuid:c2f41010-65b3-11d1-a29f-00aa00c14882/" b:dt="dateTime.rfc1123"&gt;Mon, 17 Dec 2012 18:42:59 GMT&lt;/d:getlastmodified&gt;
</code></pre>

<p>Ironically, those extra attributes with the 'b' prefix were added to be
compatible with a different, older microsoft product. This is also fixed in
version 1.7.4 / 1.8.2.</p>

<h4 id="base-url">Base url</h4>

<p>It was reported that read-write access could not be achieved when running
SabreDAV on a url like <code>/server.php/file.docx</code>. After switching to the root
using mod_rewrite, this was no longer an issue.</p>

<p>Perhaps the client doesn't like the <code>.</code> in the url.</p>
            
            
                    </article>
    </main>
    
    <!-- this is where the ugly bit starts. Stupid javascript :( -->

    <script src="https://sabre.io/components/highlightjs/highlight.pack.js"></script>
    <script>
        hljs.configure({languages: ['php']});
        hljs.initHighlightingOnLoad();
    </script>

    
    <footer>

    <nav>
        <ul>
            <li>© 2023 <a href="https://fruux.com">fruux GmbH</a> · </li>
            <li><a href="https://sabre.io/support">Contact</a> · </li>
            <li><a href="https://sabre.io/legal">Legal Info</a></li>
        </ul>
        <ul>
            <li><i class="fa fa-twitter"></i> <a href="https://twitter.com/sabredav">@sabredav</a> · </li>
            <li><a href="https://twitter.com/fruux">@fruux</a></li>
                    </ul>
    </nav>

</footer>

</body>
