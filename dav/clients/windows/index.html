<!DOCTYPE html>
<head lang="en">

    
  
            <title>Windows - sabre/dav</title>
    
    <meta charset="utf-8">

    <link rel="alternate" type="application/atom+xml" href="https://sabre.io/atom.xml" title="sabre.io blog">
    <link rel="icon" href="https://sabre.io/favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,700,300,400" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link rel="stylesheet" type="text/css" href="https://sabre.io/css/sabre.css">
    
</head>
<body >
    <header class="pagehead">

    <div class="pagehead-inner">
        <a class="logo" href="https://sabre.io/">
                            <img src="https://sabre.io/img/logo.png" alt="sabre/sabre/dav">
                sabre<span>/dav</span>
                    </a>

        <nav class="nav nav--page">
            <ul>
                <li class="size-auto"></li>
                <li><a href="https://sabre.io/dav">Docs</a></li>
                <li><a href="https://sabre.io/blog">Blog</a></li>
                <li><a href="https://sabre.io/support">Support</a></li>
                <li class="size-auto text--right"><a href="https://github.com/sabre-io"><i class="fa fa-github"></i></a></li>
                <!-- <li><a href="https://sabre.io/atom.xml"><i class="fa fa-rss"></i></a> <a href="https://twitter.com/sabredav"><i class="fa fa-twitter"></i></a></li> -->
            </ul>
        </nav>

    </div>

</header>

            <input class="hamburger-input" type="checkbox" id="nav-check" name="nav-check">
        <label class="hamburger-label" for="nav-check"><i class="fa fa-bars"></i></label>
    
        <main  class="incl-sidebar">
                    <aside class="sidebar">
    <nav class="nav nav--sidebar">
        <ul class="list list--nav">
            <li><a href="https://sabre.io/dav">sabre/dav</a>
                                <ul>
                    <li><a href="https://sabre.io/dav/install">Installation</a></li>
                    <li><a href="https://sabre.io/dav/upgrading">Upgrading</a></li>
                    <li><a href="https://sabre.io/dav/gettingstarted">Getting Started</a></li>
                    <li><a href="https://sabre.io/dav/extending-sabredav">Extending sabre/dav</a></li>
                    <li>Troubleshooting
                        <ul>
                            <li><a href="https://sabre.io/dav/faq">FAQ</a></li>
                            <li><a href="https://sabre.io/dav/clients">Clients</a></li>
                            <li><a href="https://sabre.io/dav/webservers">Webservers</a></li>
                        </ul>
                    </li>
                    <li>CalDAV
                        <ul>
                            <li><a href="https://sabre.io/dav/caldav">Getting started</a></li>
                            <li><a href="https://sabre.io/dav/building-a-caldav-client">Building a CalDAV client</a></li>
                            <li><a href="https://sabre.io/dav/caldav-carddav-integration-guide">Integration guide</a></li>
                            <li><a href="https://sabre.io/dav/caldav-proxy">Delegation</a></li>
                            <li><a href="https://sabre.io/dav/caldav-sharing">Calendar sharing</a></li>
                            <li><a href="https://sabre.io/dav/ics-export-plugin">iCalendar export</a></li>
                            <li><a href="https://sabre.io/dav/scheduling">Scheduling</a></li>
                            <li><a href="https://sabre.io/dav/service-discovery">Service Discovery</a></li>
                        </ul>
                    </li>
                    <li>CardDAV
                        <ul>
                            <li><a href="https://sabre.io/dav/carddav/">Getting started</a></li>
                            <li><a href="https://sabre.io/dav/building-a-carddav-client/">Building a CardDAV client</a></li>
                            <li><a href="https://sabre.io/dav/caldav-carddav-integration-guide/">Integration guide</a></li>
                            <li><a href="https://sabre.io/dav/carddav-directory/">CardDAV Directory</a></li>
                            <li><a href="https://sabre.io/dav/vcf-export-plugin/">vCard export</a></li>
                            <li><a href="https://sabre.io/dav/carddav-me-card/">Me-card</a></li>
                            <li><a href="https://sabre.io/dav/service-discovery/">Service Discovery</a></li>
                        </ul>
                    </li>
                    <li>Other topics
                        <ul>
                            <li><a href="https://sabre.io/dav/acl">Acl</a></li>
                            <li><a href="https://sabre.io/dav/authentication">Authentication</a></li>
                            <li><a href="https://sabre.io/dav/character-encoding">Character encoding</a></li>
                            <li><a href="https://sabre.io/dav/browser-plugin">Directory indexes</a></li>
                            <li><a href="https://sabre.io/dav/davmount">DavMount</a></li>
                            <li><a href="https://sabre.io/dav/guesscontenttype">Content Types</a></li>
                            <li><a href="https://sabre.io/dav/http-patch">PATCH support</a></li>
                            <li><a href="https://sabre.io/dav/large-files">Large files</a></li>
                            <li><a href="https://sabre.io/dav/litmus">Litmus</a></li>
                            <li><a href="https://sabre.io/dav/locks">Locks</a></li>
                            <li><a href="https://sabre.io/dav/plugins">Plugins</a></li>
                            <li><a href="https://sabre.io/dav/per-user-directories/">Per-user directories</a></li>
                            <li><a href="https://sabre.io/dav/properties">Properties</a></li>
                            <li><a href="https://sabre.io/dav/property-storage">Property storage</a></li>
                            <li><a href="https://sabre.io/dav/scalability">Scalability</a></li>
                            <li><a href="https://sabre.io/dav/simplecollection">SimpleCollection</a></li>
                            <li><a href="https://sabre.io/dav/standards-support">Standards Support</a></li>
                            <li><a href="https://sabre.io/dav/temporary-files">Temporary Files</a></li>
                            <li><a href="https://sabre.io/dav/versioning">Versioning</a></li>
                            <li><a href="https://sabre.io/dav/virtual-filesystems">Virtual filesystems</a></li>
                            <li><a href="https://sabre.io/dav/davclient">WebDAV client</a></li>
                            <li><a href="https://sabre.io/dav/sync">WebDAV sync</a></li>
                            <li><a href="https://sabre.io/dav/writing-plugins">Writing Plugins</a></li>
                            <li><a href="https://sabre.io/dav/xmlelements">XML Elements</a></li>
                        </ul>
                    </li>
                </ul>
                            </li>
            <li><a href="https://sabre.io/event">sabre/event</a>
                            </li>
            <li><a href="https://sabre.io/http">sabre/http</a>
                            </li>
            <li><a href="https://sabre.io/katana">sabre/katana</a>
                            </li>
            <li><a href="https://sabre.io/vobject">sabre/vobject</a>
                            </li>
            <li><a href="https://sabre.io/xml">sabre/xml</a>
                            </li>
            <li><a href="https://sabre.io/uri">sabre/uri</a>
                            </li>
            <li><a href="https://sabre.io/baikal/">Baïkal</a>
                            </li>
            <li><a href="https://sabre.io/license">License</a></li>
        </ul>
    </nav>
</aside>
                <article>
                            <h1>Windows</h1>
                <h2 id="setting-up-a-webdav-connection">Setting up a WebDAV connection</h2>

<ol>
<li>Open 'Computer' from your start menu or desktop</li>
<li>Open the 'Map network drive' wizard</li>
<li>Enter the full http:// address to your webdav installation</li>
</ol>

<p>Note that you need to have the Web Client service enabled and running for Web
Client to work. Some OS versions have it disabled, e.g. Windows Server 2003.
Additional some optimisation instructions lead to it being disabled.</p>

<p>You can also map a drive on the command line by typing:</p>

<pre><code>net use * http://example.org/dav/
</code></pre>

<h3 id="using-basic-auth">Using Basic Auth</h3>

<p>Basic Authentication is not supported on Windows by default, but you can turn
it on using the registry:</p>

<ul>
<li>Create a new registry key called
<code>HKLM\SYSTEM\CurrentControlSet\Services\WebClient\Parameters\UseBasicAuth</code> and</li>
<li>Set the value to '1' (without quotes).</li>
</ul>

<p>It was also reported that in certain cases
<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters\BasicAuthLevel</code>
needs to be set to 2</p>

<ul>
<li><a href="http://support.microsoft.com/?scid=kb%3Ben-us%3B928692&amp;x=21&amp;y=17">KB928692</a></li>
<li><a href="http://support.microsoft.com/kb/841215">KB841215</a></li>
</ul>

<p>Save the following to a <code>.reg</code> file and open it to simplify patching the
registry:</p>

<pre><code>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters]
"UseBasicAuth"=dword:00000001
"BasicAuthLevel"=dword:00000002
</code></pre>

<p>Make sure you restart the 'WebClient' service afterwards. You can do this via
<code>Control Panel -&gt; Performance And Maintanance -&gt; Administrative Tools -&gt; Services</code>.</p>

<h2 id="issues">Issues</h2>

<p>Windows clients have a wide range of technical issues, varying between
versions. This page aims to categorize them all and show a list of windows
versions where these issues have been confirmed.</p>

<p>The grid below has the following values:</p>

<ul>
<li>'X' - If there's a known issue for that version.</li>
<li>'?' - If the issue has not been confirmed for that version</li>
<li>Empty, if it's definitely not an issue, or assumed it's not an issue.</li>
</ul>

<table>
<thead>
<tr>
  <th>Issue name</th>
  <th>Windows XP</th>
  <th>Windows Vista</th>
  <th>Windows 7</th>
  <th>Windows 8</th>
  <th>Windows 8.1</th>
  <th>Windows 10</th>
</tr>
</thead>
<tbody>
<tr>
  <td>performance</td>
  <td></td>
  <td></td>
  <td>X</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
</tr>
<tr>
  <td>vistabug</td>
  <td></td>
  <td>X</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>root-1</td>
  <td>X</td>
  <td>X</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>root-2</td>
  <td>X</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>ms-author</td>
  <td>X</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
</tr>
<tr>
  <td>whitespace</td>
  <td>X</td>
  <td>?</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>getlastmodified</td>
  <td>X</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>charactersets</td>
  <td>X</td>
  <td>?</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>locking</td>
  <td>X</td>
  <td>?</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>filesize</td>
  <td></td>
  <td></td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
  <td>?</td>
</tr>
<tr>
  <td>displayname</td>
  <td>X</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
</tr>
<tr>
  <td>auth</td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
</tr>
<tr>
  <td>port</td>
  <td>X</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
  <td>?</td>
</tr>
<tr>
  <td>sni</td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
  <td>?</td>
  <td>?</td>
</tr>
<tr>
  <td>caching</td>
  <td></td>
  <td></td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
  <td>X</td>
</tr>
</tbody>
</table>

<h3 id="performance">performance</h3>

<p>Windows 7 has a serious performance issue with WebDAV volumes. By default,
accessing WebDAV volumes on Windows 7 is very slow.</p>

<p>The issue can be solved by unchecking "Automatic Detect Settings" in IE8 /
Tools / Internet Options / Connections / LAN Settings.</p>

<p>See <a href="http://oddballupdate.com/2009/12/18/fix-slow-webdav-performance-in-windows-7/">this article with further information</a>.</p>

<h3 id="vistabug">vistabug</h3>

<p>On Windows Vista, if you use the Web Folders client, you may need to install
<a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=17C36612-632E-4C04-9382-987622ED1D64&amp;displaylang=en">Software Update for Web Folders (KB907306)</a> to avoid the following error:
"The folder you entered does not appear to be valid".</p>

<h3 id="root1">root1</h3>

<p>These older implementations require the WebDAV service to sit at the root of a
domainname. There's no way you can connect to a url deeper in the WebDAV
structure, because it will traverse every part of the path and make PROPFIND
requests. So you have to make absolutely sure you have SabreDAV installed on a
root url. If you are using apache, you can use mod_rewrite to map every single
request to your WebDAV server, for example:</p>

<pre><code>RewriteEngine On
RewriteRule ^/(.*)$ /server.php [L]
</code></pre>

<h3 id="root2">root2</h3>

<p>Windows XP has even more quirks, and will treat the root of your WebDAV server
as if it was connecting to an SMB server. You'll notice that when you're
connecting, you will only see directories the root folder and they have icons
similar to windows shared folders. You can only really perform operations
within subdirectories on your root.</p>

<p>So:</p>

<p>make sure it is installed on the root of your domain, and make sure all
operations happen within sub-directories of your share.
The easiest way to do this is by simply creating a single top-level <code>/dav/</code>
directory.</p>

<h3 id="ms-author">ms-author</h3>

<p>Windows XP <em>requires</em> the following HTTP header when making OPTIONS requests:</p>

<pre><code>MS-Author-Via: DAV
</code></pre>

<h3 id="whitespace">whitespace</h3>

<p>Windows XP does not like whitespace in xml body responses for <code>PROPPATCH</code>
and <code>PROPFIND</code>. Make sure you send back the xml response with no whitespace
at all. It took the author a very long time to figure this out.</p>

<h3 id="getlastmodified">getlastmodified</h3>

<p>Windows XP requires a special format for the getlastmodified dav property in
the propfind response. An example is:</p>

<pre><code>&lt;d:getlastmodified xmlns:b="urn:uuid:c2f41010-65b3-11d1-a29f-00aa00c14882/" b:dt="dateTime.rfc1123"&gt;Sat, 26 Apr 2008 18:00:18 -0400&lt;/d:getlastmodified&gt;
</code></pre>

<p>This did no longer seem to be an issue with Windows XP SP3. Because this
actually causes an incompatibility with MS Office, this is removed as per
SabreDAV 1.7.4 and 1.8.2.</p>

<h3 id="charactersets">charactersets</h3>

<p>Windows XP sends encoded characters in HTTP requests as ISO-8859-1. Possibly
even CP-1252, but this has yet to be verified.</p>

<p>A converter for this purpose has been included since SabreDAV-1.2.0alpha1.</p>

<p>However, this currently only works for converting the HTTP requests coming
from windows, and not yet responses to windows. Oddly enough, windows did seem
to accept UTF-8 strings. Files could be opened, but not written to. This is
probably only the case for UTF-8 filenames that don't cleanly map to
ISO-8859-1. A workaround for this will probably not happen in the short-term.</p>

<p>These issues are verified on Windows XP SP3, but no testing has been done on
Windows Vista or Windows 7.</p>

<h3 id="locking">locking</h3>

<p>Normally windows unlocks files with the following header in the UNLOCK request:</p>

<pre><code>Lock-Token: &lt;opaquelocktoken:98b0726b-b34f-4778-9c35-da3927b6fe36&gt;
</code></pre>

<p>For some reason however, it will specify it incorrectly.</p>

<pre><code>Lock-Token: opaquelocktoken:98b0726b-b34f-4778-9c35-da3927b6fe36
</code></pre>

<p>Starting SabreDAV 1.4.3 there's a workaround for this behaviour.</p>

<h3 id="filesize">filesize</h3>

<p>Windows has introduced a file size limitation of 50000000 bytes in a security
update.</p>

<p>You may receive one of the following error messages while downloading a file
from a WebDAV volume:</p>

<ul>
<li>"Cannot Copy FileName: Cannot read from the source file or disk" (Windows
Vista or XP SP1 with security update 896426 installed)</li>
<li>"Error 0x800700DF: The file size exceeds the limit allowed and cannot be
saved." (Windows 7)</li>
<li>"An unexpected error is keeping you from copying the folder. If you continue
to receive this error, you can use the error code to search for help with
this problem." (Windows 7)</li>
</ul>

<p>The limitation can only be disabled on client side, by changing registry keys.
See <a href="http://support.microsoft.com/kb/900900/en-us">this article</a> for detailed instructions. Additional information is
also available in <a href="https://support.microsoft.com/en-us/kb/2668751">this kb article</a>.</p>

<h3 id="displayname">displayname</h3>

<p>It was reported in earlier clients (XP at least, and perhaps Vista too) that
sending back a displayname can cause the client to use the displayname instead
of a url to access resources.</p>

<p>This will cause all kinds of bugs, so it's best to avoid <code>{DAV:}displayname</code>
entirely. It was was reported that this bug was 'fixed' in Windows 7 by taking
out support for <code>{DAV:}displayname</code> entirely.</p>

<h3 id="auth">auth</h3>

<p>HTTP Digest is support across the board. HTTP Basic auth can be used directly
from within IE, but will not work by default if you're using Web Client, unless
WebDAV is used over SSL.</p>

<p>Basic auth can be enabled if the following registry change is made:</p>

<ul>
<li>Create a new registry key called
<code>HKLM\SYSTEM\CurrentControlSet\Services\WebClient\Parameters\UseBasicAuth</code> and</li>
<li>Set the value to '1' (without quotes).</li>
</ul>

<p>It was also reported that in certain cases
<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters\BasicAuthLevel</code>
needs to be set to 2</p>

<ul>
<li><a href="http://support.microsoft.com/?scid=kb%3Ben-us%3B928692&amp;x=21&amp;y=17">KB928692</a></li>
<li><a href="http://support.microsoft.com/kb/841215">KB841215</a></li>
</ul>

<p>Save the following to a <code>.reg</code> file and open it to simplify patching the
registry:</p>

<pre><code>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters]
"UseBasicAuth"=dword:00000001
"BasicAuthLevel"=dword:00000002
</code></pre>

<p>In some cases Windows will incorrectly prepend the NT domain to the username
with two backslashes. Example:</p>

<pre><code>MYDOMAIN\\username
</code></pre>

<p>The workaround for this is making the user go through all the login prompts
(removing the NT domain), it will succeed after a while. It would also be
possible to automatically detect and strip out these usernames but that could
be problematic in relation to HTTP digest authentication.</p>

<h3 id="port">port</h3>

<p>It appears that Windows does not support ports other than the default (80).
Make sure your server is not running on a non-default http port.</p>

<h3 id="sni">sni</h3>

<p>It was reported that the Windows 7 and 8 (and likely older clients as well) do
not support 'SNI' (server name identification), which is a technology that
allows virtual hosting of multiple HTTPS domains on one server.</p>

<p>If you're running into issues with this, make sure you don't host more than
one HTTPS-based domain off one ip address, or make sure that it's the default.</p>

<p>In the case of apache, the default https server would be the top-most
virtualhost definition.</p>

<p>Furthermore it was reported that the WinHTTP API (used in the Windows WebDAV client)
doesn't support TSLv1.1/TSLv1.2 connections. If you have restricted your server
config to only provide TLSv1.1 and above the connection to your server will fail.</p>

<p>See <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa382925%28v=vs.85%29.aspx">this article with further information</a>.</p>

<h3 id="caching">caching</h3>

<p>It was reported that Windows 7 has a 60 second cache, which may be frustrating
if you expect an immediate update.</p>

<p>This can be disabled using a registry key. See <a href="http://technet.microsoft.com/en-us/library/ee683963%28v=ws.10%29.aspx">http://technet.microsoft.com/en-us/library/ee683963%28v=ws.10%29.aspx</a> for more info.</p>

<h3 id="upload-timeouts">upload timeouts</h3>

<p>An upload of large files taking longer than 30 minutes using Web Client in
Windows 7 can cause the following error:</p>

<ul>
<li>"Error: 0x80070079 The semaphore timeout period has expired"</li>
</ul>

<p>See <a href="https://support.microsoft.com/en-us/kb/2668751">this kb article</a> for detailed instructions how to raise the timeout.</p>

<h2 id="technical-details">Technical details</h2>

<p>User agents:</p>

<pre><code>Vista:
Microsoft-WebDAV-MiniRedir/6.0.6000

XP:
Microsoft-WebDAV-MiniRedir/5.1.2600
Microsoft Data Access Internet Publishing Provider DAV 1.1
Microsoft Data Access Internet Publishing Provider Cache Manager
</code></pre>

<h3 id="properties">Properties</h3>

<p>Windows XP requests the following webdav properties when making requests:</p>

<ul>
<li>name</li>
<li>parentname</li>
<li>href</li>
<li>ishidden</li>
<li>iscollection</li>
<li>isreadonly</li>
<li>getcontenttype</li>
<li>contentclass</li>
<li>getcontentlanguage</li>
<li>creationdate</li>
<li>lastaccessed</li>
<li>getlastmodified</li>
<li>getcontentlength</li>
<li>resourcetype</li>
<li>isstructureddocument</li>
<li>defaultdocument</li>
<li>displayname</li>
<li>isroot</li>
</ul>

<p>Windows (XP and Vista) introduces the following properties under the
<code>urn:schemas-microsoft-com:</code> xml namespace:</p>

<ul>
<li>Win32CreationTime (example: Sat, 26 Apr 2008 20:38:50 GMT)</li>
<li>Win32LastAccessTime (same format)</li>
<li>Win32LastModifiedTime (same format)</li>
<li>Win32FileAttributes (example: 00002020) indicates the classic MS-DOS properties, such as 'read only, hidden, archive, system' and a couple of newer ones. Haven't located detailed docs yet</li>
</ul>

<p>To easily take advantage of these properties, enable the <a href="/dav/property-storage/">propertystorage plugin</a>.</p>

<h2 id="using-web-folders">Using Web Folders</h2>

<p>Before Windows 7, Windows had a feature called 'Web folders'. This is a
different WebDAV client with less features. This feature is removed in
Windows 7.</p>

<p>To use it:</p>

<p># Open up Internet Explorer
  # Press File, Open and fill in the full url
  # Check the "Open as Web Folder" setting
  # Press Ok</p>
            
            
                    </article>
    </main>
    
    <!-- this is where the ugly bit starts. Stupid javascript :( -->

    <script src="https://sabre.io/components/highlightjs/highlight.pack.js"></script>
    <script>
        hljs.configure({languages: ['php']});
        hljs.initHighlightingOnLoad();
    </script>

    
    <footer>

    <nav>
        <ul>
            <li>© 2023 <a href="https://fruux.com">fruux GmbH</a> · </li>
            <li><a href="https://sabre.io/support">Contact</a> · </li>
            <li><a href="https://sabre.io/legal">Legal Info</a></li>
        </ul>
        <ul>
            <li><i class="fa fa-twitter"></i> <a href="https://twitter.com/sabredav">@sabredav</a> · </li>
            <li><a href="https://twitter.com/fruux">@fruux</a></li>
                    </ul>
    </nav>

</footer>

</body>
